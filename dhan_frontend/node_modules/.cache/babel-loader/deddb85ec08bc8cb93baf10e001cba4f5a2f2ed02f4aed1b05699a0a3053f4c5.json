{"ast":null,"code":"var _jsxFileName = \"/home/hp/Documents/Dhan_Trading_Bot/dhan_frontend/src/components/PnlReport.js\",\n  _s = $RefreshSig$();\n// ####################################################################################################################################\n\n// import React, { useEffect, useState, useCallback } from \"react\";\n// import { io } from \"socket.io-client\";\n\n// const socket = io(\"http://127.0.0.1:5000\", {\n//     transports: [\"websocket\"], \n//     reconnectionAttempts: 5,   \n//     reconnectionDelay: 2000,    \n// });\n\n// const PnlReport = () => {\n//     const [pnlData, setPnlData] = useState([]);\n//     const [livePrices, setLivePrices] = useState({});  \n//     const [loading, setLoading] = useState(true);\n//     const [error, setError] = useState(null);\n\n//     const fetchInitialData = async () => {\n//         try {\n//             const response = await fetch(\"http://127.0.0.1:5000/api/pnl-report\");\n//             if (!response.ok) {\n//                 throw new Error(`HTTP error! Status: ${response.status}`);\n//             }\n//             const data = await response.json();\n//             console.log(\"âœ… Initial API Data:\", data);\n\n//             if (data.status === \"success\") {\n//                 setPnlData(data.orders || []);\n//                 setLivePrices(data.live_prices || {});\n//             } else {\n//                 throw new Error(\"Invalid API response structure.\");\n//             }\n//         } catch (err) {\n//             console.error(\"Error fetching initial data:\", err);\n//             setError(\"Failed to fetch initial data.\");\n//         }\n//         setLoading(false);\n//     };\n\n//     const handlePnLUpdate = useCallback((data) => {\n//         console.log(\"ðŸ”„ WebSocket Received Update:\", data);\n\n//         if (data.status === \"success\" && data.live_prices) {\n//             setLivePrices(prevLivePrices => ({\n//                 ...prevLivePrices,\n//                 ...data.live_prices,\n//             }));\n//         } else {\n//             setError(\"Invalid WebSocket data.\");\n//         }\n//     }, []);\n\n//     useEffect(() => {\n//         fetchInitialData();\n\n//         socket.on(\"pnl_update\", handlePnLUpdate);\n//         socket.on(\"connect\", () => console.log(\"âœ… WebSocket connected!\"));\n//         socket.on(\"disconnect\", () => console.log(\"âŒ WebSocket disconnected!\"));\n//         socket.on(\"connect_error\", (err) => {\n//             console.error(\"WebSocket connection error:\", err.message || err);\n//             setError(\"WebSocket connection failed.\");\n//         });\n\n//         return () => {\n//             socket.off(\"pnl_update\", handlePnLUpdate);\n//         };\n//     }, [handlePnLUpdate]);\n\n//     const totalPnL = pnlData.reduce((sum, order) => {\n//         const currentPrice = livePrices[order.security_id] || order.price;\n//         return sum + (currentPrice - order.price) * order.quantity;\n//     }, 0).toFixed(2);\n\n//     const totalPnLPercentage = pnlData.reduce((sum, order) => {\n//         const currentPrice = livePrices[order.security_id] || order.price;\n//         return sum + (((currentPrice - order.price) / order.price) * 100);\n//     }, 0).toFixed(2);\n\n//     return (\n//         <div className=\"p-6 bg-gray-900 min-h-screen flex flex-col items-center text-white\">\n//             <h2 className=\"text-2xl font-bold mb-4\">ðŸ“Š Live PnL Report</h2>\n//             {loading ? (\n//                 <p className=\"text-gray-300\">Fetching data...</p>\n//             ) : error ? (\n//                 <p className=\"text-red-500 font-semibold\">{error}</p>\n//             ) : (\n//                 <div className=\"w-full max-w-5xl bg-gray-800 shadow-md rounded-lg overflow-hidden\">\n//                     <div className=\"overflow-x-auto\">\n//                         <table className=\"w-full text-sm text-gray-300\">\n//                             <thead className=\"bg-blue-600 text-white uppercase text-xs\">\n//                                 <tr>\n//                                     <th className=\"px-4 py-2\">Order ID</th>\n//                                     <th className=\"px-4 py-2\">Security ID</th>\n//                                     <th className=\"px-4 py-2\">Type</th>\n//                                     <th className=\"px-4 py-2\">Quantity</th>\n//                                     <th className=\"px-4 py-2\">Entry Price</th>\n//                                     <th className=\"px-4 py-2\">Latest Price</th>\n//                                     <th className=\"px-4 py-2\">PnL</th>\n//                                     <th className=\"px-4 py-2\">PnL %</th>\n//                                     <th className=\"px-4 py-2\">Profit/Loss</th>\n//                                 </tr>\n//                             </thead>\n//                             <tbody className=\"divide-y divide-gray-700\">\n//                                 {pnlData.length === 0 ? (\n//                                     <tr>\n//                                         <td colSpan=\"9\" className=\"p-4 text-center text-gray-500\">\n//                                             No orders available.\n//                                         </td>\n//                                     </tr>\n//                                 ) : (\n//                                     pnlData.map((order) => {\n//                                         const currentPrice = livePrices[order.security_id] || order.price;\n//                                         const pnl = ((currentPrice - order.price) * order.quantity).toFixed(2);\n//                                         const pnlPercentage = (((currentPrice - order.price) / order.price) * 100).toFixed(2);\n//                                         const profitLoss = pnl >= 0 ? \"Profit\" : \"Loss\";\n//                                         return (\n//                                             <tr key={order.order_id} className=\"hover:bg-gray-700\">\n//                                                 <td className=\"px-4 py-2\">{order.order_id || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.security_id || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.transaction_type || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.quantity || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.price || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2 text-yellow-400 font-semibold\">{currentPrice}</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnl}</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnlPercentage}%</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{profitLoss}</td>\n//                                             </tr>\n//                                         );\n//                                     })\n//                                 )}\n//                             </tbody>\n//                             <tfoot className=\"bg-gray-700 text-white font-bold\">\n//                                 <tr>\n//                                     <td colSpan=\"6\" className=\"px-6 py-2 text-left\">Total   :-</td>\n//                                     <td className={`px-4 py-2 ${totalPnL >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnL}</td>\n//                                     <td className={`px-4 py-2 ${totalPnLPercentage >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnLPercentage}%</td>\n//                                     <td className=\"px-4 py-2\">â€”</td>\n//                                 </tr>\n//                             </tfoot>\n//                         </table>\n//                     </div>\n//                 </div>\n//             )}\n//         </div>\n//     );\n// };\n\n// export default PnlReport;\n\n// ##########################################################################################################################################\n\n// import React, { useEffect, useState, useCallback } from \"react\";\n// import { io } from \"socket.io-client\";\n\n// const socket = io(\"http://127.0.0.1:5000\", {\n//     transports: [\"websocket\"], \n//     reconnectionAttempts: 5,   \n//     reconnectionDelay: 2000,    \n// });\n\n// const PnlReport = () => {\n//     const [pnlData, setPnlData] = useState([]);\n//     const [livePrices, setLivePrices] = useState({});  \n//     const [loading, setLoading] = useState(true);\n//     const [error, setError] = useState(null);\n\n//     // Function to fetch initial PnL data\n//     const fetchInitialData = async () => {\n//         try {\n//             const response = await fetch(\"http://127.0.0.1:5000/api/pnl-report\");\n//             if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);\n\n//             const data = await response.json();\n//             console.log(\"âœ… Initial API Data:\", data);\n\n//             if (data.status === \"success\") {\n//                 setPnlData(data.orders || []);\n//                 setLivePrices(data.live_prices || {});\n//             } else {\n//                 throw new Error(\"Invalid API response structure.\");\n//             }\n//         } catch (err) {\n//             console.error(\"Error fetching initial data:\", err);\n//             setError(\"Failed to fetch initial data.\");\n//         }\n//         setLoading(false);\n//     };\n\n//     // WebSocket update handler\n//     const handlePnLUpdate = useCallback((data) => {\n//         console.log(\"ðŸ”„ WebSocket Received Update:\", data); // Log the received data\n\n//         if (data?.status === \"success\" && data?.live_prices) {\n//             setLivePrices(prevLivePrices => {\n//                 const updatedPrices = { ...prevLivePrices, ...data.live_prices };\n//                 console.log(\"âœ… Updated Prices:\", updatedPrices); // Log updated prices\n\n//                 // Update PnL Data with new prices\n//                 setPnlData(prevPnlData => {\n//                     return prevPnlData.map(order => {\n//                         const newPrice = updatedPrices[order.security_id] || order.price;\n//                         console.log(`ðŸ”¹ Updating ${order.security_id}: ${order.price} -> ${newPrice}`);\n//                         return { ...order, latest_price: newPrice };\n//                     });\n//                 });\n\n//                 return updatedPrices;\n//             });\n//         } else {\n//             console.error(\"âŒ Invalid WebSocket data received:\", data);\n//             setError(\"Invalid WebSocket data.\");\n//         }\n//     }, []);\n\n//     // WebSocket connection setup\n//     useEffect(() => {\n//         fetchInitialData();\n\n//         socket.on(\"pnl_update\", handlePnLUpdate);\n//         socket.on(\"connect\", () => console.log(\"âœ… WebSocket Connected!\"));\n//         socket.on(\"disconnect\", () => console.log(\"âŒ WebSocket Disconnected!\"));\n//         socket.on(\"connect_error\", (err) => {\n//             console.error(\"âŒ WebSocket connection error:\", err.message || err);\n//             setError(\"WebSocket connection failed.\");\n//         });\n\n//         return () => {\n//             socket.off(\"pnl_update\", handlePnLUpdate);\n//             socket.off(\"connect\");\n//             socket.off(\"disconnect\");\n//             socket.off(\"connect_error\");\n//         };\n//     }, [handlePnLUpdate]);\n\n//     // Calculate total PnL\n//     const totalPnL = pnlData.reduce((sum, order) => {\n//         const currentPrice = livePrices[order.security_id] || order.price;\n//         return sum + (currentPrice - order.price) * order.quantity;\n//     }, 0).toFixed(2);\n\n//     const totalPnLPercentage = pnlData.reduce((sum, order) => {\n//         const currentPrice = livePrices[order.security_id] || order.price;\n//         return sum + (((currentPrice - order.price) / order.price) * 100);\n//     }, 0).toFixed(2);\n\n//     return (\n//         <div className=\"p-6 bg-gray-900 min-h-screen flex flex-col items-center text-white\">\n//             <h2 className=\"text-2xl font-bold mb-4\">ðŸ“Š Live PnL Report</h2>\n//             {loading ? (\n//                 <p className=\"text-gray-300\">Fetching data...</p>\n//             ) : error ? (\n//                 <p className=\"text-red-500 font-semibold\">{error}</p>\n//             ) : (\n//                 <div className=\"w-full max-w-5xl bg-gray-800 shadow-md rounded-lg overflow-hidden\">\n//                     <div className=\"overflow-x-auto\">\n//                         <table className=\"w-full text-sm text-gray-300\">\n//                             <thead className=\"bg-blue-600 text-white uppercase text-xs\">\n//                                 <tr>\n//                                     <th className=\"px-4 py-2\">Order ID</th>\n//                                     <th className=\"px-4 py-2\">Security ID</th>\n//                                     <th className=\"px-4 py-2\">Type</th>\n//                                     <th className=\"px-4 py-2\">Quantity</th>\n//                                     <th className=\"px-4 py-2\">Entry Price</th>\n//                                     <th className=\"px-4 py-2\">Latest Price</th>\n//                                     <th className=\"px-4 py-2\">PnL</th>\n//                                     <th className=\"px-4 py-2\">PnL %</th>\n//                                     <th className=\"px-4 py-2\">Profit/Loss</th>\n//                                 </tr>\n//                             </thead>\n//                             <tbody className=\"divide-y divide-gray-700\">\n//                                 {pnlData.length === 0 ? (\n//                                     <tr>\n//                                         <td colSpan=\"9\" className=\"p-4 text-center text-gray-500\">\n//                                             No orders available.\n//                                         </td>\n//                                     </tr>\n//                                 ) : (\n//                                     pnlData.map((order) => {\n//                                         const currentPrice = livePrices[order.security_id] || order.price;\n//                                         const pnl = ((currentPrice - order.price) * order.quantity).toFixed(2);\n//                                         const pnlPercentage = (((currentPrice - order.price) / order.price) * 100).toFixed(2);\n//                                         const profitLoss = pnl >= 0 ? \"Profit\" : \"Loss\";\n//                                         return (\n//                                             <tr key={order.order_id} className=\"hover:bg-gray-700\">\n//                                                 <td className=\"px-4 py-2\">{order.order_id || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.security_id || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.transaction_type || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.quantity || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.price || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2 text-yellow-400 font-semibold\">{currentPrice}</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnl}</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnlPercentage}%</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{profitLoss}</td>\n//                                             </tr>\n//                                         );\n//                                     })\n//                                 )}\n//                             </tbody>\n//                             <tfoot className=\"bg-gray-700 text-white font-bold\">\n//                                 <tr>\n//                                     <td colSpan=\"6\" className=\"px-6 py-2 text-left\">Total   :-</td>\n//                                     <td className={`px-4 py-2 ${totalPnL >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnL}</td>\n//                                     <td className={`px-4 py-2 ${totalPnLPercentage >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnLPercentage}%</td>\n//                                     <td className=\"px-4 py-2\">â€”</td>\n//                                 </tr>\n//                             </tfoot>\n//                         </table>\n//                     </div>\n//                 </div>\n//             )}\n//         </div>\n//     );\n// };\n\n// export default PnlReport;\n\n// import React, { useEffect, useState, useCallback } from \"react\";\n// import { io } from \"socket.io-client\";\n\n// const socket = io(\"http://127.0.0.1:5000\", {\n//     transports: [\"websocket\"], \n//     reconnectionAttempts: 5,   \n//     reconnectionDelay: 2000,    \n// });\n\n// const PnlReport = () => {\n//     const [pnlData, setPnlData] = useState([]);\n//     const [livePrices, setLivePrices] = useState({});\n//     const [loading, setLoading] = useState(true);\n//     const [error, setError] = useState(null);\n\n//     // Fetch Initial PnL Data\n//     const fetchInitialData = async () => {\n//         try {\n//             const response = await fetch(\"http://127.0.0.1:5000/api/pnl-report\");\n//             if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);\n\n//             const data = await response.json();\n//             console.log(\"âœ… Initial API Data:\", data);\n\n//             if (data.status === \"success\") {\n//                 setPnlData(data.orders || []);\n//                 setLivePrices(data.live_prices || {});\n//             } else {\n//                 throw new Error(\"Invalid API response structure.\");\n//             }\n//         } catch (err) {\n//             console.error(\"Error fetching initial data:\", err);\n//             setError(\"Failed to fetch initial data.\");\n//         }\n//         setLoading(false);\n//     };\n\n//     // WebSocket Update Handler\n//     const handlePnLUpdate = useCallback((data) => {\n//         console.log(\"ðŸ”„ WebSocket Received Update:\", data);\n\n//         if (!data || data.status !== \"success\" || !data.live_prices) {\n//             console.error(\"âŒ Invalid WebSocket data received:\", data);\n//             setError(\"Invalid WebSocket data.\");\n//             return;\n//         }\n\n//         // Update Live Prices\n//         setLivePrices(prev => {\n//             const updatedPrices = { ...prev, ...data.live_prices };\n//             console.log(\"âœ… Updated Live Prices:\", updatedPrices);\n//             return updatedPrices;\n//         });\n\n//         // Update PnL Data with New Prices\n//         setPnlData(prevPnlData =>\n//             prevPnlData.map(order => ({\n//                 ...order,\n//                 latest_price: data.live_prices[order.security_id] || order.price\n//             }))\n//         );\n//     }, []);\n\n//     // WebSocket Connection Setup\n//     useEffect(() => {\n//         fetchInitialData();\n\n//         console.log(\"âœ… Setting up WebSocket listeners...\");\n//         socket.on(\"pnl_update\", handlePnLUpdate);\n//         socket.on(\"connect\", () => console.log(\"âœ… WebSocket Connected!\"));\n//         socket.on(\"disconnect\", () => console.log(\"âŒ WebSocket Disconnected!\"));\n//         socket.on(\"connect_error\", (err) => console.error(\"âŒ WebSocket connection error:\", err));\n\n//         return () => {\n//             console.log(\"ðŸ›‘ Cleaning up WebSocket listeners...\");\n//             socket.off(\"pnl_update\", handlePnLUpdate);\n//             socket.off(\"connect\");\n//             socket.off(\"disconnect\");\n//             socket.off(\"connect_error\");\n//         };\n//     }, [handlePnLUpdate]);\n\n//     // Calculate Total PnL\n//     const totalPnL = pnlData.reduce((sum, order) => {\n//         const currentPrice = livePrices[order.security_id] || order.price;\n//         return sum + (currentPrice - order.price) * order.quantity;\n//     }, 0).toFixed(2);\n\n//     const totalPnLPercentage = pnlData.reduce((sum, order) => {\n//         const currentPrice = livePrices[order.security_id] || order.price;\n//         return sum + (((currentPrice - order.price) / order.price) * 100);\n//     }, 0).toFixed(2);\n\n//     return (\n//         <div className=\"p-6 bg-gray-900 min-h-screen flex flex-col items-center text-white\">\n//             <h2 className=\"text-2xl font-bold mb-4\">ðŸ“Š Live PnL Report</h2>\n//             {loading ? (\n//                 <p className=\"text-gray-300\">Fetching data...</p>\n//             ) : error ? (\n//                 <p className=\"text-red-500 font-semibold\">{error}</p>\n//             ) : (\n//                 <div className=\"w-full max-w-5xl bg-gray-800 shadow-md rounded-lg overflow-hidden\">\n//                     <div className=\"overflow-x-auto\">\n//                         <table className=\"w-full text-sm text-gray-300\">\n//                             <thead className=\"bg-blue-600 text-white uppercase text-xs\">\n//                                 <tr>\n//                                     <th className=\"px-4 py-2\">Order ID</th>\n//                                     <th className=\"px-4 py-2\">Security ID</th>\n//                                     <th className=\"px-4 py-2\">Type</th>\n//                                     <th className=\"px-4 py-2\">Quantity</th>\n//                                     <th className=\"px-4 py-2\">Entry Price</th>\n//                                     <th className=\"px-4 py-2\">Latest Price</th>\n//                                     <th className=\"px-4 py-2\">PnL</th>\n//                                     <th className=\"px-4 py-2\">PnL %</th>\n//                                     <th className=\"px-4 py-2\">Profit/Loss</th>\n//                                 </tr>\n//                             </thead>\n//                             <tbody className=\"divide-y divide-gray-700\">\n//                                 {pnlData.length === 0 ? (\n//                                     <tr>\n//                                         <td colSpan=\"9\" className=\"p-4 text-center text-gray-500\">\n//                                             No orders available.\n//                                         </td>\n//                                     </tr>\n//                                 ) : (\n//                                     pnlData.map((order) => {\n//                                         const currentPrice = livePrices[order.security_id] || order.price;\n//                                         const pnl = ((currentPrice - order.price) * order.quantity).toFixed(2);\n//                                         const pnlPercentage = (((currentPrice - order.price) / order.price) * 100).toFixed(2);\n//                                         const profitLoss = pnl >= 0 ? \"Profit\" : \"Loss\";\n//                                         return (\n//                                             <tr key={order.order_id} className=\"hover:bg-gray-700\">\n//                                                 <td className=\"px-4 py-2\">{order.order_id || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.security_id || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.transaction_type || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.quantity || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.price || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2 text-yellow-400 font-semibold\">{currentPrice}</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnl}</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnlPercentage}%</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{profitLoss}</td>\n//                                             </tr>\n//                                         );\n//                                     })\n//                                 )}\n//                             </tbody>\n//                             <tfoot className=\"bg-gray-700 text-white font-bold\">\n//                                 <tr>\n//                                     <td colSpan=\"6\" className=\"px-6 py-2 text-left\">Total:</td>\n//                                     <td className={`px-4 py-2 ${totalPnL >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnL}</td>\n//                                     <td className={`px-4 py-2 ${totalPnLPercentage >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnLPercentage}%</td>\n//                                     <td className=\"px-4 py-2\">â€”</td>\n//                                 </tr>\n//                             </tfoot>\n//                         </table>\n//                     </div>\n//                 </div>\n//             )}\n//         </div>\n//     );\n// };\n\n// export default PnlReport;\n\n// import React, { useEffect, useState, useCallback } from \"react\";\n// import { io } from \"socket.io-client\";\n\n// const socket = io(\"http://127.0.0.1:5000\", {\n//     transports: [\"websocket\"],\n//     reconnectionAttempts: 5,\n//     reconnectionDelay: 2000,\n// });\n\n// const PnlReport = () => {\n//     const [pnlData, setPnlData] = useState([]);\n//     const [livePrices, setLivePrices] = useState({});\n//     const [loading, setLoading] = useState(true);\n//     const [error, setError] = useState(null);\n\n//     // ðŸ”¹ Fetch Initial Data from API\n//     const fetchInitialData = async () => {\n//         try {\n//             const response = await fetch(\"http://127.0.0.1:5000/api/pnl-report\");\n//             if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);\n\n//             const data = await response.json();\n//             console.log(\"âœ… Initial API Data:\", data);\n\n//             if (data.status === \"success\") {\n//                 setPnlData(data.orders || []);\n//                 setLivePrices(data.live_prices || {});\n//             } else {\n//                 throw new Error(\"Invalid API response structure.\");\n//             }\n//         } catch (err) {\n//             console.error(\"Error fetching initial data:\", err);\n//             setError(\"Failed to fetch initial data.\");\n//         }\n//         setLoading(false);\n//     };\n\n//     // ðŸ”¹ WebSocket Update Handler\n//     const handlePnLUpdate = useCallback((data) => {\n//         console.log(\"ðŸ”„ WebSocket Received Update:\", data);\n\n//         if (!data || data.status !== \"success\" || !data.live_prices) {\n//             console.error(\"âŒ Invalid WebSocket data received:\", data);\n//             setError(\"Invalid WebSocket data.\");\n//             return;\n//         }\n\n//         // ðŸ”¹ Log Live Prices for Debugging\n//         console.log(\"âœ… New Live Prices:\", data.live_prices);\n\n//         // ðŸ”¹ Ensure prices update correctly\n//         setLivePrices(prev => {\n//             const updatedPrices = { ...prev, ...data.live_prices };\n//             console.log(\"âœ… Updated Live Prices State:\", updatedPrices);\n//             return updatedPrices;\n//         });\n\n//         // ðŸ”¹ Update PnL Data\n//         setPnlData(prevPnlData =>\n//             prevPnlData.map(order => ({\n//                 ...order,\n//                 latest_price: data.live_prices[order.security_id] ?? order.price\n//             }))\n//         );\n//     }, []);\n\n//     // ðŸ”¹ WebSocket Connection Setup\n//     useEffect(() => {\n//         fetchInitialData();\n\n//         console.log(\"âœ… Setting up WebSocket listeners...\");\n//         socket.on(\"pnl_update\", handlePnLUpdate);\n//         socket.on(\"connect\", () => console.log(\"âœ… WebSocket Connected!\"));\n//         socket.on(\"disconnect\", () => console.log(\"âŒ WebSocket Disconnected!\"));\n//         socket.on(\"connect_error\", (err) => console.error(\"âŒ WebSocket connection error:\", err));\n\n//         return () => {\n//             console.log(\"ðŸ›‘ Cleaning up WebSocket listeners...\");\n//             socket.off(\"pnl_update\", handlePnLUpdate);\n//             socket.off(\"connect\");\n//             socket.off(\"disconnect\");\n//             socket.off(\"connect_error\");\n//         };\n//     }, [handlePnLUpdate]);\n\n//     // ðŸ”¹ Calculate Total PnL\n//     const totalPnL = pnlData.reduce((sum, order) => {\n//         const currentPrice = livePrices[order.security_id] ?? order.price;\n//         return sum + (currentPrice - order.price) * order.quantity;\n//     }, 0).toFixed(2);\n\n//     const totalPnLPercentage = pnlData.reduce((sum, order) => {\n//         const currentPrice = livePrices[order.security_id] ?? order.price;\n//         return sum + (((currentPrice - order.price) / order.price) * 100);\n//     }, 0).toFixed(2);\n\n//     return (\n//         <div className=\"p-6 bg-gray-900 min-h-screen flex flex-col items-center text-white\">\n//             <h2 className=\"text-2xl font-bold mb-4\">ðŸ“Š Live PnL Report</h2>\n//             {loading ? (\n//                 <p className=\"text-gray-300\">Fetching data...</p>\n//             ) : error ? (\n//                 <p className=\"text-red-500 font-semibold\">{error}</p>\n//             ) : (\n//                 <div className=\"w-full max-w-5xl bg-gray-800 shadow-md rounded-lg overflow-hidden\">\n//                     <div className=\"overflow-x-auto\">\n//                         <table className=\"w-full text-sm text-gray-300\">\n//                             <thead className=\"bg-blue-600 text-white uppercase text-xs\">\n//                                 <tr>\n//                                     <th className=\"px-4 py-2\">Order ID</th>\n//                                     <th className=\"px-4 py-2\">Security ID</th>\n//                                     <th className=\"px-4 py-2\">Type</th>\n//                                     <th className=\"px-4 py-2\">Quantity</th>\n//                                     <th className=\"px-4 py-2\">Entry Price</th>\n//                                     <th className=\"px-4 py-2\">Latest Price</th>\n//                                     <th className=\"px-4 py-2\">PnL</th>\n//                                     <th className=\"px-4 py-2\">PnL %</th>\n//                                     <th className=\"px-4 py-2\">Profit/Loss</th>\n//                                 </tr>\n//                             </thead>\n//                             <tbody className=\"divide-y divide-gray-700\">\n//                                 {pnlData.length === 0 ? (\n//                                     <tr>\n//                                         <td colSpan=\"9\" className=\"p-4 text-center text-gray-500\">\n//                                             No orders available.\n//                                         </td>\n//                                     </tr>\n//                                 ) : (\n//                                     pnlData.map((order) => {\n//                                         const currentPrice = livePrices[order.security_id] ?? order.price;\n//                                         const pnl = ((currentPrice - order.price) * order.quantity).toFixed(2);\n//                                         const pnlPercentage = (((currentPrice - order.price) / order.price) * 100).toFixed(2);\n//                                         const profitLoss = pnl >= 0 ? \"Profit\" : \"Loss\";\n//                                         return (\n//                                             <tr key={order.order_id} className=\"hover:bg-gray-700\">\n//                                                 <td className=\"px-4 py-2\">{order.order_id ?? \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.security_id ?? \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.transaction_type ?? \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.quantity ?? \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.price ?? \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2 text-yellow-400 font-semibold\">{currentPrice}</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnl}</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnlPercentage}%</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{profitLoss}</td>\n//                                             </tr>\n//                                         );\n//                                     })\n//                                 )}\n//                             </tbody>\n//                             <tfoot className=\"bg-gray-700 text-white font-bold\">\n//                                 <tr>\n//                                     <td colSpan=\"6\" className=\"px-6 py-2 text-left\">Total:</td>\n//                                     <td className={`px-4 py-2 ${totalPnL >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnL}</td>\n//                                     <td className={`px-4 py-2 ${totalPnLPercentage >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnLPercentage}%</td>\n//                                     <td className=\"px-4 py-2\">â€”</td>\n//                                 </tr>\n//                             </tfoot>\n//                         </table>\n//                     </div>\n//                 </div>\n//             )}\n//         </div>\n//     );\n// };\n\n// export default PnlReport;\n\nimport React, { useEffect, useState, useCallback } from \"react\";\nimport { io } from \"socket.io-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst socket = io(\"http://127.0.0.1:5000\", {\n  transports: [\"websocket\"],\n  reconnectionAttempts: 5,\n  reconnectionDelay: 2000\n});\nconst PnlReport = () => {\n  _s();\n  const [pnlData, setPnlData] = useState([]);\n  const [livePrices, setLivePrices] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Fetch Initial Data from API\n  const fetchInitialData = async () => {\n    try {\n      const response = await fetch(\"http://127.0.0.1:5000/api/pnl-report\");\n      if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);\n      const data = await response.json();\n      console.log(\"âœ… Initial API Data:\", data);\n      if (data.status === \"success\") {\n        setPnlData(data.orders || []);\n        setLivePrices(data.live_prices || {});\n      } else {\n        throw new Error(\"Invalid API response structure.\");\n      }\n    } catch (err) {\n      console.error(\"Error fetching initial data:\", err);\n      setError(\"Failed to fetch initial data.\");\n    }\n    setLoading(false);\n  };\n\n  // WebSocket Update Handler\n  const handlePnLUpdate = useCallback(data => {\n    console.log(\"ðŸ”„ WebSocket Received Update:\", data);\n    if (!data || data.status !== \"success\" || !data.pnl_report) {\n      console.error(\"âŒ Invalid WebSocket data received:\", data);\n      setError(\"Invalid WebSocket data.\");\n      return;\n    }\n\n    // Extract live prices from pnl_report\n    const updatedPrices = data.pnl_report.reduce((acc, order) => {\n      acc[order.security_id] = order.current_price;\n      return acc;\n    }, {});\n    console.log(\"âœ… Extracted Live Prices from WebSocket:\", updatedPrices);\n\n    // Update livePrices state\n    setLivePrices(prev => {\n      const newPrices = {\n        ...prev,\n        ...updatedPrices\n      };\n      console.log(\"âœ… Updated Live Prices State:\", newPrices);\n      return newPrices;\n    });\n\n    // Update pnlData with latest prices\n    setPnlData(prevPnlData => prevPnlData.map(order => {\n      var _updatedPrices$order$;\n      return {\n        ...order,\n        latest_price: (_updatedPrices$order$ = updatedPrices[order.security_id]) !== null && _updatedPrices$order$ !== void 0 ? _updatedPrices$order$ : order.price\n      };\n    }));\n  }, []);\n\n  // WebSocket Connection Setup\n  useEffect(() => {\n    fetchInitialData();\n    console.log(\"âœ… Setting up WebSocket listeners...\");\n    socket.on(\"connect\", () => console.log(\"âœ… WebSocket Connected!\"));\n    socket.on(\"disconnect\", () => console.log(\"âŒ WebSocket Disconnected!\"));\n    socket.on(\"connect_error\", err => console.error(\"âŒ WebSocket connection error:\", err));\n    socket.on(\"pnl_update\", handlePnLUpdate);\n    return () => {\n      console.log(\"ðŸ›‘ Cleaning up WebSocket listeners...\");\n      socket.off(\"connect\");\n      socket.off(\"disconnect\");\n      socket.off(\"connect_error\");\n      socket.off(\"pnl_update\", handlePnLUpdate);\n    };\n  }, [handlePnLUpdate]);\n\n  // Calculate Total PnL\n  const totalPnL = pnlData.reduce((sum, order) => {\n    var _livePrices$order$sec;\n    const currentPrice = (_livePrices$order$sec = livePrices[order.security_id]) !== null && _livePrices$order$sec !== void 0 ? _livePrices$order$sec : order.price;\n    return sum + (currentPrice - order.price) * order.quantity;\n  }, 0).toFixed(2);\n  const totalPnLPercentage = pnlData.reduce((sum, order) => {\n    var _livePrices$order$sec2;\n    const currentPrice = (_livePrices$order$sec2 = livePrices[order.security_id]) !== null && _livePrices$order$sec2 !== void 0 ? _livePrices$order$sec2 : order.price;\n    return sum + (currentPrice - order.price) / order.price * 100;\n  }, 0).toFixed(2);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-6 bg-gray-900 min-h-screen flex flex-col items-center text-white\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-2xl font-bold mb-4\",\n      children: \"\\uD83D\\uDCCA Live PnL Report\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 784,\n      columnNumber: 13\n    }, this), loading ? /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-gray-300\",\n      children: \"Fetching data...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 786,\n      columnNumber: 17\n    }, this) : error ? /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-red-500 font-semibold\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 788,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full max-w-5xl bg-gray-800 shadow-md rounded-lg overflow-hidden\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"overflow-x-auto\",\n        children: /*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"w-full text-sm text-gray-300\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            className: \"bg-blue-600 text-white uppercase text-xs\",\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2\",\n                children: \"Order ID\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 795,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2\",\n                children: \"Security ID\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 796,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2\",\n                children: \"Type\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 797,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2\",\n                children: \"Quantity\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 798,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2\",\n                children: \"Entry Price\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 799,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2\",\n                children: \"Latest Price\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 800,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2\",\n                children: \"PnL\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 801,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2\",\n                children: \"PnL %\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 802,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2\",\n                children: \"Profit/Loss\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 803,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 794,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 793,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            className: \"divide-y divide-gray-700\",\n            children: pnlData.length === 0 ? /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: /*#__PURE__*/_jsxDEV(\"td\", {\n                colSpan: \"9\",\n                className: \"p-4 text-center text-gray-500\",\n                children: \"No orders available.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 809,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 808,\n              columnNumber: 37\n            }, this) : pnlData.map(order => {\n              var _livePrices$order$sec3, _order$order_id, _order$security_id, _order$transaction_ty, _order$quantity, _order$price;\n              const currentPrice = (_livePrices$order$sec3 = livePrices[order.security_id]) !== null && _livePrices$order$sec3 !== void 0 ? _livePrices$order$sec3 : order.price;\n              const pnl = ((currentPrice - order.price) * order.quantity).toFixed(2);\n              const pnlPercentage = ((currentPrice - order.price) / order.price * 100).toFixed(2);\n              const profitLoss = pnl >= 0 ? \"Profit\" : \"Loss\";\n              return /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"hover:bg-gray-700\",\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-4 py-2\",\n                  children: (_order$order_id = order.order_id) !== null && _order$order_id !== void 0 ? _order$order_id : \"N/A\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 821,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-4 py-2\",\n                  children: (_order$security_id = order.security_id) !== null && _order$security_id !== void 0 ? _order$security_id : \"N/A\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 822,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-4 py-2\",\n                  children: (_order$transaction_ty = order.transaction_type) !== null && _order$transaction_ty !== void 0 ? _order$transaction_ty : \"N/A\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 823,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-4 py-2\",\n                  children: (_order$quantity = order.quantity) !== null && _order$quantity !== void 0 ? _order$quantity : \"N/A\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 824,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-4 py-2\",\n                  children: (_order$price = order.price) !== null && _order$price !== void 0 ? _order$price : \"N/A\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 825,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-4 py-2 text-yellow-400 font-semibold\",\n                  children: currentPrice\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 826,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: `px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`,\n                  children: pnl\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 827,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: `px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`,\n                  children: [pnlPercentage, \"%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 828,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: `px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`,\n                  children: profitLoss\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 829,\n                  columnNumber: 49\n                }, this)]\n              }, order.order_id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 820,\n                columnNumber: 45\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 806,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"tfoot\", {\n            className: \"bg-gray-700 text-white font-bold\",\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                colSpan: \"6\",\n                className: \"px-6 py-2 text-left\",\n                children: \"Total:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 837,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: `px-4 py-2 ${totalPnL >= 0 ? \"text-green-500\" : \"text-red-500\"}`,\n                children: totalPnL\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 838,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: `px-4 py-2 ${totalPnLPercentage >= 0 ? \"text-green-500\" : \"text-red-500\"}`,\n                children: [totalPnLPercentage, \"%\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 839,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-4 py-2\",\n                children: \"\\u2014\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 840,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 836,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 835,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 792,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 791,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 790,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 783,\n    columnNumber: 9\n  }, this);\n};\n_s(PnlReport, \"MjKVYx6+pkbEh6wu3K+Jx77gHPs=\");\n_c = PnlReport;\nexport default PnlReport;\nvar _c;\n$RefreshReg$(_c, \"PnlReport\");","map":{"version":3,"names":["React","useEffect","useState","useCallback","io","jsxDEV","_jsxDEV","socket","transports","reconnectionAttempts","reconnectionDelay","PnlReport","_s","pnlData","setPnlData","livePrices","setLivePrices","loading","setLoading","error","setError","fetchInitialData","response","fetch","ok","Error","status","data","json","console","log","orders","live_prices","err","handlePnLUpdate","pnl_report","updatedPrices","reduce","acc","order","security_id","current_price","prev","newPrices","prevPnlData","map","_updatedPrices$order$","latest_price","price","on","off","totalPnL","sum","_livePrices$order$sec","currentPrice","quantity","toFixed","totalPnLPercentage","_livePrices$order$sec2","className","children","fileName","_jsxFileName","lineNumber","columnNumber","length","colSpan","_livePrices$order$sec3","_order$order_id","_order$security_id","_order$transaction_ty","_order$quantity","_order$price","pnl","pnlPercentage","profitLoss","order_id","transaction_type","_c","$RefreshReg$"],"sources":["/home/hp/Documents/Dhan_Trading_Bot/dhan_frontend/src/components/PnlReport.js"],"sourcesContent":["\n// ####################################################################################################################################\n\n// import React, { useEffect, useState, useCallback } from \"react\";\n// import { io } from \"socket.io-client\";\n\n// const socket = io(\"http://127.0.0.1:5000\", {\n//     transports: [\"websocket\"], \n//     reconnectionAttempts: 5,   \n//     reconnectionDelay: 2000,    \n// });\n\n// const PnlReport = () => {\n//     const [pnlData, setPnlData] = useState([]);\n//     const [livePrices, setLivePrices] = useState({});  \n//     const [loading, setLoading] = useState(true);\n//     const [error, setError] = useState(null);\n\n//     const fetchInitialData = async () => {\n//         try {\n//             const response = await fetch(\"http://127.0.0.1:5000/api/pnl-report\");\n//             if (!response.ok) {\n//                 throw new Error(`HTTP error! Status: ${response.status}`);\n//             }\n//             const data = await response.json();\n//             console.log(\"âœ… Initial API Data:\", data);\n\n//             if (data.status === \"success\") {\n//                 setPnlData(data.orders || []);\n//                 setLivePrices(data.live_prices || {});\n//             } else {\n//                 throw new Error(\"Invalid API response structure.\");\n//             }\n//         } catch (err) {\n//             console.error(\"Error fetching initial data:\", err);\n//             setError(\"Failed to fetch initial data.\");\n//         }\n//         setLoading(false);\n//     };\n\n//     const handlePnLUpdate = useCallback((data) => {\n//         console.log(\"ðŸ”„ WebSocket Received Update:\", data);\n\n//         if (data.status === \"success\" && data.live_prices) {\n//             setLivePrices(prevLivePrices => ({\n//                 ...prevLivePrices,\n//                 ...data.live_prices,\n//             }));\n//         } else {\n//             setError(\"Invalid WebSocket data.\");\n//         }\n//     }, []);\n\n//     useEffect(() => {\n//         fetchInitialData();\n\n//         socket.on(\"pnl_update\", handlePnLUpdate);\n//         socket.on(\"connect\", () => console.log(\"âœ… WebSocket connected!\"));\n//         socket.on(\"disconnect\", () => console.log(\"âŒ WebSocket disconnected!\"));\n//         socket.on(\"connect_error\", (err) => {\n//             console.error(\"WebSocket connection error:\", err.message || err);\n//             setError(\"WebSocket connection failed.\");\n//         });\n\n//         return () => {\n//             socket.off(\"pnl_update\", handlePnLUpdate);\n//         };\n//     }, [handlePnLUpdate]);\n\n//     const totalPnL = pnlData.reduce((sum, order) => {\n//         const currentPrice = livePrices[order.security_id] || order.price;\n//         return sum + (currentPrice - order.price) * order.quantity;\n//     }, 0).toFixed(2);\n\n//     const totalPnLPercentage = pnlData.reduce((sum, order) => {\n//         const currentPrice = livePrices[order.security_id] || order.price;\n//         return sum + (((currentPrice - order.price) / order.price) * 100);\n//     }, 0).toFixed(2);\n\n//     return (\n//         <div className=\"p-6 bg-gray-900 min-h-screen flex flex-col items-center text-white\">\n//             <h2 className=\"text-2xl font-bold mb-4\">ðŸ“Š Live PnL Report</h2>\n//             {loading ? (\n//                 <p className=\"text-gray-300\">Fetching data...</p>\n//             ) : error ? (\n//                 <p className=\"text-red-500 font-semibold\">{error}</p>\n//             ) : (\n//                 <div className=\"w-full max-w-5xl bg-gray-800 shadow-md rounded-lg overflow-hidden\">\n//                     <div className=\"overflow-x-auto\">\n//                         <table className=\"w-full text-sm text-gray-300\">\n//                             <thead className=\"bg-blue-600 text-white uppercase text-xs\">\n//                                 <tr>\n//                                     <th className=\"px-4 py-2\">Order ID</th>\n//                                     <th className=\"px-4 py-2\">Security ID</th>\n//                                     <th className=\"px-4 py-2\">Type</th>\n//                                     <th className=\"px-4 py-2\">Quantity</th>\n//                                     <th className=\"px-4 py-2\">Entry Price</th>\n//                                     <th className=\"px-4 py-2\">Latest Price</th>\n//                                     <th className=\"px-4 py-2\">PnL</th>\n//                                     <th className=\"px-4 py-2\">PnL %</th>\n//                                     <th className=\"px-4 py-2\">Profit/Loss</th>\n//                                 </tr>\n//                             </thead>\n//                             <tbody className=\"divide-y divide-gray-700\">\n//                                 {pnlData.length === 0 ? (\n//                                     <tr>\n//                                         <td colSpan=\"9\" className=\"p-4 text-center text-gray-500\">\n//                                             No orders available.\n//                                         </td>\n//                                     </tr>\n//                                 ) : (\n//                                     pnlData.map((order) => {\n//                                         const currentPrice = livePrices[order.security_id] || order.price;\n//                                         const pnl = ((currentPrice - order.price) * order.quantity).toFixed(2);\n//                                         const pnlPercentage = (((currentPrice - order.price) / order.price) * 100).toFixed(2);\n//                                         const profitLoss = pnl >= 0 ? \"Profit\" : \"Loss\";\n//                                         return (\n//                                             <tr key={order.order_id} className=\"hover:bg-gray-700\">\n//                                                 <td className=\"px-4 py-2\">{order.order_id || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.security_id || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.transaction_type || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.quantity || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.price || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2 text-yellow-400 font-semibold\">{currentPrice}</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnl}</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnlPercentage}%</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{profitLoss}</td>\n//                                             </tr>\n//                                         );\n//                                     })\n//                                 )}\n//                             </tbody>\n//                             <tfoot className=\"bg-gray-700 text-white font-bold\">\n//                                 <tr>\n//                                     <td colSpan=\"6\" className=\"px-6 py-2 text-left\">Total   :-</td>\n//                                     <td className={`px-4 py-2 ${totalPnL >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnL}</td>\n//                                     <td className={`px-4 py-2 ${totalPnLPercentage >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnLPercentage}%</td>\n//                                     <td className=\"px-4 py-2\">â€”</td>\n//                                 </tr>\n//                             </tfoot>\n//                         </table>\n//                     </div>\n//                 </div>\n//             )}\n//         </div>\n//     );\n// };\n\n// export default PnlReport;\n\n\n// ##########################################################################################################################################\n\n\n\n\n// import React, { useEffect, useState, useCallback } from \"react\";\n// import { io } from \"socket.io-client\";\n\n// const socket = io(\"http://127.0.0.1:5000\", {\n//     transports: [\"websocket\"], \n//     reconnectionAttempts: 5,   \n//     reconnectionDelay: 2000,    \n// });\n\n// const PnlReport = () => {\n//     const [pnlData, setPnlData] = useState([]);\n//     const [livePrices, setLivePrices] = useState({});  \n//     const [loading, setLoading] = useState(true);\n//     const [error, setError] = useState(null);\n\n//     // Function to fetch initial PnL data\n//     const fetchInitialData = async () => {\n//         try {\n//             const response = await fetch(\"http://127.0.0.1:5000/api/pnl-report\");\n//             if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);\n            \n//             const data = await response.json();\n//             console.log(\"âœ… Initial API Data:\", data);\n\n//             if (data.status === \"success\") {\n//                 setPnlData(data.orders || []);\n//                 setLivePrices(data.live_prices || {});\n//             } else {\n//                 throw new Error(\"Invalid API response structure.\");\n//             }\n//         } catch (err) {\n//             console.error(\"Error fetching initial data:\", err);\n//             setError(\"Failed to fetch initial data.\");\n//         }\n//         setLoading(false);\n//     };\n\n//     // WebSocket update handler\n//     const handlePnLUpdate = useCallback((data) => {\n//         console.log(\"ðŸ”„ WebSocket Received Update:\", data); // Log the received data\n    \n//         if (data?.status === \"success\" && data?.live_prices) {\n//             setLivePrices(prevLivePrices => {\n//                 const updatedPrices = { ...prevLivePrices, ...data.live_prices };\n//                 console.log(\"âœ… Updated Prices:\", updatedPrices); // Log updated prices\n    \n//                 // Update PnL Data with new prices\n//                 setPnlData(prevPnlData => {\n//                     return prevPnlData.map(order => {\n//                         const newPrice = updatedPrices[order.security_id] || order.price;\n//                         console.log(`ðŸ”¹ Updating ${order.security_id}: ${order.price} -> ${newPrice}`);\n//                         return { ...order, latest_price: newPrice };\n//                     });\n//                 });\n    \n//                 return updatedPrices;\n//             });\n//         } else {\n//             console.error(\"âŒ Invalid WebSocket data received:\", data);\n//             setError(\"Invalid WebSocket data.\");\n//         }\n//     }, []);\n    \n    \n\n//     // WebSocket connection setup\n//     useEffect(() => {\n//         fetchInitialData();\n    \n//         socket.on(\"pnl_update\", handlePnLUpdate);\n//         socket.on(\"connect\", () => console.log(\"âœ… WebSocket Connected!\"));\n//         socket.on(\"disconnect\", () => console.log(\"âŒ WebSocket Disconnected!\"));\n//         socket.on(\"connect_error\", (err) => {\n//             console.error(\"âŒ WebSocket connection error:\", err.message || err);\n//             setError(\"WebSocket connection failed.\");\n//         });\n    \n//         return () => {\n//             socket.off(\"pnl_update\", handlePnLUpdate);\n//             socket.off(\"connect\");\n//             socket.off(\"disconnect\");\n//             socket.off(\"connect_error\");\n//         };\n//     }, [handlePnLUpdate]);\n    \n\n//     // Calculate total PnL\n//     const totalPnL = pnlData.reduce((sum, order) => {\n//         const currentPrice = livePrices[order.security_id] || order.price;\n//         return sum + (currentPrice - order.price) * order.quantity;\n//     }, 0).toFixed(2);\n\n//     const totalPnLPercentage = pnlData.reduce((sum, order) => {\n//         const currentPrice = livePrices[order.security_id] || order.price;\n//         return sum + (((currentPrice - order.price) / order.price) * 100);\n//     }, 0).toFixed(2);\n\n//     return (\n//         <div className=\"p-6 bg-gray-900 min-h-screen flex flex-col items-center text-white\">\n//             <h2 className=\"text-2xl font-bold mb-4\">ðŸ“Š Live PnL Report</h2>\n//             {loading ? (\n//                 <p className=\"text-gray-300\">Fetching data...</p>\n//             ) : error ? (\n//                 <p className=\"text-red-500 font-semibold\">{error}</p>\n//             ) : (\n//                 <div className=\"w-full max-w-5xl bg-gray-800 shadow-md rounded-lg overflow-hidden\">\n//                     <div className=\"overflow-x-auto\">\n//                         <table className=\"w-full text-sm text-gray-300\">\n//                             <thead className=\"bg-blue-600 text-white uppercase text-xs\">\n//                                 <tr>\n//                                     <th className=\"px-4 py-2\">Order ID</th>\n//                                     <th className=\"px-4 py-2\">Security ID</th>\n//                                     <th className=\"px-4 py-2\">Type</th>\n//                                     <th className=\"px-4 py-2\">Quantity</th>\n//                                     <th className=\"px-4 py-2\">Entry Price</th>\n//                                     <th className=\"px-4 py-2\">Latest Price</th>\n//                                     <th className=\"px-4 py-2\">PnL</th>\n//                                     <th className=\"px-4 py-2\">PnL %</th>\n//                                     <th className=\"px-4 py-2\">Profit/Loss</th>\n//                                 </tr>\n//                             </thead>\n//                             <tbody className=\"divide-y divide-gray-700\">\n//                                 {pnlData.length === 0 ? (\n//                                     <tr>\n//                                         <td colSpan=\"9\" className=\"p-4 text-center text-gray-500\">\n//                                             No orders available.\n//                                         </td>\n//                                     </tr>\n//                                 ) : (\n//                                     pnlData.map((order) => {\n//                                         const currentPrice = livePrices[order.security_id] || order.price;\n//                                         const pnl = ((currentPrice - order.price) * order.quantity).toFixed(2);\n//                                         const pnlPercentage = (((currentPrice - order.price) / order.price) * 100).toFixed(2);\n//                                         const profitLoss = pnl >= 0 ? \"Profit\" : \"Loss\";\n//                                         return (\n//                                             <tr key={order.order_id} className=\"hover:bg-gray-700\">\n//                                                 <td className=\"px-4 py-2\">{order.order_id || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.security_id || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.transaction_type || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.quantity || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.price || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2 text-yellow-400 font-semibold\">{currentPrice}</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnl}</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnlPercentage}%</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{profitLoss}</td>\n//                                             </tr>\n//                                         );\n//                                     })\n//                                 )}\n//                             </tbody>\n//                             <tfoot className=\"bg-gray-700 text-white font-bold\">\n//                                 <tr>\n//                                     <td colSpan=\"6\" className=\"px-6 py-2 text-left\">Total   :-</td>\n//                                     <td className={`px-4 py-2 ${totalPnL >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnL}</td>\n//                                     <td className={`px-4 py-2 ${totalPnLPercentage >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnLPercentage}%</td>\n//                                     <td className=\"px-4 py-2\">â€”</td>\n//                                 </tr>\n//                             </tfoot>\n//                         </table>\n//                     </div>\n//                 </div>\n//             )}\n//         </div>\n//     );\n// };\n\n// export default PnlReport;\n\n\n\n\n\n\n\n\n\n// import React, { useEffect, useState, useCallback } from \"react\";\n// import { io } from \"socket.io-client\";\n\n// const socket = io(\"http://127.0.0.1:5000\", {\n//     transports: [\"websocket\"], \n//     reconnectionAttempts: 5,   \n//     reconnectionDelay: 2000,    \n// });\n\n// const PnlReport = () => {\n//     const [pnlData, setPnlData] = useState([]);\n//     const [livePrices, setLivePrices] = useState({});\n//     const [loading, setLoading] = useState(true);\n//     const [error, setError] = useState(null);\n\n//     // Fetch Initial PnL Data\n//     const fetchInitialData = async () => {\n//         try {\n//             const response = await fetch(\"http://127.0.0.1:5000/api/pnl-report\");\n//             if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);\n            \n//             const data = await response.json();\n//             console.log(\"âœ… Initial API Data:\", data);\n\n//             if (data.status === \"success\") {\n//                 setPnlData(data.orders || []);\n//                 setLivePrices(data.live_prices || {});\n//             } else {\n//                 throw new Error(\"Invalid API response structure.\");\n//             }\n//         } catch (err) {\n//             console.error(\"Error fetching initial data:\", err);\n//             setError(\"Failed to fetch initial data.\");\n//         }\n//         setLoading(false);\n//     };\n\n//     // WebSocket Update Handler\n//     const handlePnLUpdate = useCallback((data) => {\n//         console.log(\"ðŸ”„ WebSocket Received Update:\", data);\n\n//         if (!data || data.status !== \"success\" || !data.live_prices) {\n//             console.error(\"âŒ Invalid WebSocket data received:\", data);\n//             setError(\"Invalid WebSocket data.\");\n//             return;\n//         }\n\n//         // Update Live Prices\n//         setLivePrices(prev => {\n//             const updatedPrices = { ...prev, ...data.live_prices };\n//             console.log(\"âœ… Updated Live Prices:\", updatedPrices);\n//             return updatedPrices;\n//         });\n\n//         // Update PnL Data with New Prices\n//         setPnlData(prevPnlData =>\n//             prevPnlData.map(order => ({\n//                 ...order,\n//                 latest_price: data.live_prices[order.security_id] || order.price\n//             }))\n//         );\n//     }, []);\n\n//     // WebSocket Connection Setup\n//     useEffect(() => {\n//         fetchInitialData();\n    \n//         console.log(\"âœ… Setting up WebSocket listeners...\");\n//         socket.on(\"pnl_update\", handlePnLUpdate);\n//         socket.on(\"connect\", () => console.log(\"âœ… WebSocket Connected!\"));\n//         socket.on(\"disconnect\", () => console.log(\"âŒ WebSocket Disconnected!\"));\n//         socket.on(\"connect_error\", (err) => console.error(\"âŒ WebSocket connection error:\", err));\n\n//         return () => {\n//             console.log(\"ðŸ›‘ Cleaning up WebSocket listeners...\");\n//             socket.off(\"pnl_update\", handlePnLUpdate);\n//             socket.off(\"connect\");\n//             socket.off(\"disconnect\");\n//             socket.off(\"connect_error\");\n//         };\n//     }, [handlePnLUpdate]);\n\n//     // Calculate Total PnL\n//     const totalPnL = pnlData.reduce((sum, order) => {\n//         const currentPrice = livePrices[order.security_id] || order.price;\n//         return sum + (currentPrice - order.price) * order.quantity;\n//     }, 0).toFixed(2);\n\n//     const totalPnLPercentage = pnlData.reduce((sum, order) => {\n//         const currentPrice = livePrices[order.security_id] || order.price;\n//         return sum + (((currentPrice - order.price) / order.price) * 100);\n//     }, 0).toFixed(2);\n\n//     return (\n//         <div className=\"p-6 bg-gray-900 min-h-screen flex flex-col items-center text-white\">\n//             <h2 className=\"text-2xl font-bold mb-4\">ðŸ“Š Live PnL Report</h2>\n//             {loading ? (\n//                 <p className=\"text-gray-300\">Fetching data...</p>\n//             ) : error ? (\n//                 <p className=\"text-red-500 font-semibold\">{error}</p>\n//             ) : (\n//                 <div className=\"w-full max-w-5xl bg-gray-800 shadow-md rounded-lg overflow-hidden\">\n//                     <div className=\"overflow-x-auto\">\n//                         <table className=\"w-full text-sm text-gray-300\">\n//                             <thead className=\"bg-blue-600 text-white uppercase text-xs\">\n//                                 <tr>\n//                                     <th className=\"px-4 py-2\">Order ID</th>\n//                                     <th className=\"px-4 py-2\">Security ID</th>\n//                                     <th className=\"px-4 py-2\">Type</th>\n//                                     <th className=\"px-4 py-2\">Quantity</th>\n//                                     <th className=\"px-4 py-2\">Entry Price</th>\n//                                     <th className=\"px-4 py-2\">Latest Price</th>\n//                                     <th className=\"px-4 py-2\">PnL</th>\n//                                     <th className=\"px-4 py-2\">PnL %</th>\n//                                     <th className=\"px-4 py-2\">Profit/Loss</th>\n//                                 </tr>\n//                             </thead>\n//                             <tbody className=\"divide-y divide-gray-700\">\n//                                 {pnlData.length === 0 ? (\n//                                     <tr>\n//                                         <td colSpan=\"9\" className=\"p-4 text-center text-gray-500\">\n//                                             No orders available.\n//                                         </td>\n//                                     </tr>\n//                                 ) : (\n//                                     pnlData.map((order) => {\n//                                         const currentPrice = livePrices[order.security_id] || order.price;\n//                                         const pnl = ((currentPrice - order.price) * order.quantity).toFixed(2);\n//                                         const pnlPercentage = (((currentPrice - order.price) / order.price) * 100).toFixed(2);\n//                                         const profitLoss = pnl >= 0 ? \"Profit\" : \"Loss\";\n//                                         return (\n//                                             <tr key={order.order_id} className=\"hover:bg-gray-700\">\n//                                                 <td className=\"px-4 py-2\">{order.order_id || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.security_id || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.transaction_type || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.quantity || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.price || \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2 text-yellow-400 font-semibold\">{currentPrice}</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnl}</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnlPercentage}%</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{profitLoss}</td>\n//                                             </tr>\n//                                         );\n//                                     })\n//                                 )}\n//                             </tbody>\n//                             <tfoot className=\"bg-gray-700 text-white font-bold\">\n//                                 <tr>\n//                                     <td colSpan=\"6\" className=\"px-6 py-2 text-left\">Total:</td>\n//                                     <td className={`px-4 py-2 ${totalPnL >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnL}</td>\n//                                     <td className={`px-4 py-2 ${totalPnLPercentage >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnLPercentage}%</td>\n//                                     <td className=\"px-4 py-2\">â€”</td>\n//                                 </tr>\n//                             </tfoot>\n//                         </table>\n//                     </div>\n//                 </div>\n//             )}\n//         </div>\n//     );\n// };\n\n// export default PnlReport;\n\n\n\n\n\n\n\n\n\n\n\n// import React, { useEffect, useState, useCallback } from \"react\";\n// import { io } from \"socket.io-client\";\n\n// const socket = io(\"http://127.0.0.1:5000\", {\n//     transports: [\"websocket\"],\n//     reconnectionAttempts: 5,\n//     reconnectionDelay: 2000,\n// });\n\n// const PnlReport = () => {\n//     const [pnlData, setPnlData] = useState([]);\n//     const [livePrices, setLivePrices] = useState({});\n//     const [loading, setLoading] = useState(true);\n//     const [error, setError] = useState(null);\n\n//     // ðŸ”¹ Fetch Initial Data from API\n//     const fetchInitialData = async () => {\n//         try {\n//             const response = await fetch(\"http://127.0.0.1:5000/api/pnl-report\");\n//             if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);\n\n//             const data = await response.json();\n//             console.log(\"âœ… Initial API Data:\", data);\n\n//             if (data.status === \"success\") {\n//                 setPnlData(data.orders || []);\n//                 setLivePrices(data.live_prices || {});\n//             } else {\n//                 throw new Error(\"Invalid API response structure.\");\n//             }\n//         } catch (err) {\n//             console.error(\"Error fetching initial data:\", err);\n//             setError(\"Failed to fetch initial data.\");\n//         }\n//         setLoading(false);\n//     };\n\n//     // ðŸ”¹ WebSocket Update Handler\n//     const handlePnLUpdate = useCallback((data) => {\n//         console.log(\"ðŸ”„ WebSocket Received Update:\", data);\n\n//         if (!data || data.status !== \"success\" || !data.live_prices) {\n//             console.error(\"âŒ Invalid WebSocket data received:\", data);\n//             setError(\"Invalid WebSocket data.\");\n//             return;\n//         }\n\n//         // ðŸ”¹ Log Live Prices for Debugging\n//         console.log(\"âœ… New Live Prices:\", data.live_prices);\n\n//         // ðŸ”¹ Ensure prices update correctly\n//         setLivePrices(prev => {\n//             const updatedPrices = { ...prev, ...data.live_prices };\n//             console.log(\"âœ… Updated Live Prices State:\", updatedPrices);\n//             return updatedPrices;\n//         });\n\n//         // ðŸ”¹ Update PnL Data\n//         setPnlData(prevPnlData =>\n//             prevPnlData.map(order => ({\n//                 ...order,\n//                 latest_price: data.live_prices[order.security_id] ?? order.price\n//             }))\n//         );\n//     }, []);\n\n//     // ðŸ”¹ WebSocket Connection Setup\n//     useEffect(() => {\n//         fetchInitialData();\n\n//         console.log(\"âœ… Setting up WebSocket listeners...\");\n//         socket.on(\"pnl_update\", handlePnLUpdate);\n//         socket.on(\"connect\", () => console.log(\"âœ… WebSocket Connected!\"));\n//         socket.on(\"disconnect\", () => console.log(\"âŒ WebSocket Disconnected!\"));\n//         socket.on(\"connect_error\", (err) => console.error(\"âŒ WebSocket connection error:\", err));\n\n//         return () => {\n//             console.log(\"ðŸ›‘ Cleaning up WebSocket listeners...\");\n//             socket.off(\"pnl_update\", handlePnLUpdate);\n//             socket.off(\"connect\");\n//             socket.off(\"disconnect\");\n//             socket.off(\"connect_error\");\n//         };\n//     }, [handlePnLUpdate]);\n\n//     // ðŸ”¹ Calculate Total PnL\n//     const totalPnL = pnlData.reduce((sum, order) => {\n//         const currentPrice = livePrices[order.security_id] ?? order.price;\n//         return sum + (currentPrice - order.price) * order.quantity;\n//     }, 0).toFixed(2);\n\n//     const totalPnLPercentage = pnlData.reduce((sum, order) => {\n//         const currentPrice = livePrices[order.security_id] ?? order.price;\n//         return sum + (((currentPrice - order.price) / order.price) * 100);\n//     }, 0).toFixed(2);\n\n//     return (\n//         <div className=\"p-6 bg-gray-900 min-h-screen flex flex-col items-center text-white\">\n//             <h2 className=\"text-2xl font-bold mb-4\">ðŸ“Š Live PnL Report</h2>\n//             {loading ? (\n//                 <p className=\"text-gray-300\">Fetching data...</p>\n//             ) : error ? (\n//                 <p className=\"text-red-500 font-semibold\">{error}</p>\n//             ) : (\n//                 <div className=\"w-full max-w-5xl bg-gray-800 shadow-md rounded-lg overflow-hidden\">\n//                     <div className=\"overflow-x-auto\">\n//                         <table className=\"w-full text-sm text-gray-300\">\n//                             <thead className=\"bg-blue-600 text-white uppercase text-xs\">\n//                                 <tr>\n//                                     <th className=\"px-4 py-2\">Order ID</th>\n//                                     <th className=\"px-4 py-2\">Security ID</th>\n//                                     <th className=\"px-4 py-2\">Type</th>\n//                                     <th className=\"px-4 py-2\">Quantity</th>\n//                                     <th className=\"px-4 py-2\">Entry Price</th>\n//                                     <th className=\"px-4 py-2\">Latest Price</th>\n//                                     <th className=\"px-4 py-2\">PnL</th>\n//                                     <th className=\"px-4 py-2\">PnL %</th>\n//                                     <th className=\"px-4 py-2\">Profit/Loss</th>\n//                                 </tr>\n//                             </thead>\n//                             <tbody className=\"divide-y divide-gray-700\">\n//                                 {pnlData.length === 0 ? (\n//                                     <tr>\n//                                         <td colSpan=\"9\" className=\"p-4 text-center text-gray-500\">\n//                                             No orders available.\n//                                         </td>\n//                                     </tr>\n//                                 ) : (\n//                                     pnlData.map((order) => {\n//                                         const currentPrice = livePrices[order.security_id] ?? order.price;\n//                                         const pnl = ((currentPrice - order.price) * order.quantity).toFixed(2);\n//                                         const pnlPercentage = (((currentPrice - order.price) / order.price) * 100).toFixed(2);\n//                                         const profitLoss = pnl >= 0 ? \"Profit\" : \"Loss\";\n//                                         return (\n//                                             <tr key={order.order_id} className=\"hover:bg-gray-700\">\n//                                                 <td className=\"px-4 py-2\">{order.order_id ?? \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.security_id ?? \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.transaction_type ?? \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.quantity ?? \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2\">{order.price ?? \"N/A\"}</td>\n//                                                 <td className=\"px-4 py-2 text-yellow-400 font-semibold\">{currentPrice}</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnl}</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnlPercentage}%</td>\n//                                                 <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{profitLoss}</td>\n//                                             </tr>\n//                                         );\n//                                     })\n//                                 )}\n//                             </tbody>\n//                             <tfoot className=\"bg-gray-700 text-white font-bold\">\n//                                 <tr>\n//                                     <td colSpan=\"6\" className=\"px-6 py-2 text-left\">Total:</td>\n//                                     <td className={`px-4 py-2 ${totalPnL >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnL}</td>\n//                                     <td className={`px-4 py-2 ${totalPnLPercentage >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnLPercentage}%</td>\n//                                     <td className=\"px-4 py-2\">â€”</td>\n//                                 </tr>\n//                             </tfoot>\n//                         </table>\n//                     </div>\n//                 </div>\n//             )}\n//         </div>\n//     );\n// };\n\n// export default PnlReport;\n\n\n\n\n\n\n\n\nimport React, { useEffect, useState, useCallback } from \"react\";\nimport { io } from \"socket.io-client\";\n\nconst socket = io(\"http://127.0.0.1:5000\", {\n    transports: [\"websocket\"],\n    reconnectionAttempts: 5,\n    reconnectionDelay: 2000,\n});\n\nconst PnlReport = () => {\n    const [pnlData, setPnlData] = useState([]);\n    const [livePrices, setLivePrices] = useState({});\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    // Fetch Initial Data from API\n    const fetchInitialData = async () => {\n        try {\n            const response = await fetch(\"http://127.0.0.1:5000/api/pnl-report\");\n            if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);\n\n            const data = await response.json();\n            console.log(\"âœ… Initial API Data:\", data);\n\n            if (data.status === \"success\") {\n                setPnlData(data.orders || []);\n                setLivePrices(data.live_prices || {});\n            } else {\n                throw new Error(\"Invalid API response structure.\");\n            }\n        } catch (err) {\n            console.error(\"Error fetching initial data:\", err);\n            setError(\"Failed to fetch initial data.\");\n        }\n        setLoading(false);\n    };\n\n    // WebSocket Update Handler\n    const handlePnLUpdate = useCallback((data) => {\n        console.log(\"ðŸ”„ WebSocket Received Update:\", data);\n\n        if (!data || data.status !== \"success\" || !data.pnl_report) {\n            console.error(\"âŒ Invalid WebSocket data received:\", data);\n            setError(\"Invalid WebSocket data.\");\n            return;\n        }\n\n        // Extract live prices from pnl_report\n        const updatedPrices = data.pnl_report.reduce((acc, order) => {\n            acc[order.security_id] = order.current_price;\n            return acc;\n        }, {});\n\n        console.log(\"âœ… Extracted Live Prices from WebSocket:\", updatedPrices);\n\n        // Update livePrices state\n        setLivePrices(prev => {\n            const newPrices = { ...prev, ...updatedPrices };\n            console.log(\"âœ… Updated Live Prices State:\", newPrices);\n            return newPrices;\n        });\n\n        // Update pnlData with latest prices\n        setPnlData(prevPnlData =>\n            prevPnlData.map(order => ({\n                ...order,\n                latest_price: updatedPrices[order.security_id] ?? order.price,\n            }))\n        );\n    }, []);\n\n    // WebSocket Connection Setup\n    useEffect(() => {\n        fetchInitialData();\n\n        console.log(\"âœ… Setting up WebSocket listeners...\");\n        socket.on(\"connect\", () => console.log(\"âœ… WebSocket Connected!\"));\n        socket.on(\"disconnect\", () => console.log(\"âŒ WebSocket Disconnected!\"));\n        socket.on(\"connect_error\", (err) => console.error(\"âŒ WebSocket connection error:\", err));\n        socket.on(\"pnl_update\", handlePnLUpdate);\n\n        return () => {\n            console.log(\"ðŸ›‘ Cleaning up WebSocket listeners...\");\n            socket.off(\"connect\");\n            socket.off(\"disconnect\");\n            socket.off(\"connect_error\");\n            socket.off(\"pnl_update\", handlePnLUpdate);\n        };\n    }, [handlePnLUpdate]);\n\n    // Calculate Total PnL\n    const totalPnL = pnlData.reduce((sum, order) => {\n        const currentPrice = livePrices[order.security_id] ?? order.price;\n        return sum + (currentPrice - order.price) * order.quantity;\n    }, 0).toFixed(2);\n\n    const totalPnLPercentage = pnlData.reduce((sum, order) => {\n        const currentPrice = livePrices[order.security_id] ?? order.price;\n        return sum + (((currentPrice - order.price) / order.price) * 100);\n    }, 0).toFixed(2);\n\n    return (\n        <div className=\"p-6 bg-gray-900 min-h-screen flex flex-col items-center text-white\">\n            <h2 className=\"text-2xl font-bold mb-4\">ðŸ“Š Live PnL Report</h2>\n            {loading ? (\n                <p className=\"text-gray-300\">Fetching data...</p>\n            ) : error ? (\n                <p className=\"text-red-500 font-semibold\">{error}</p>\n            ) : (\n                <div className=\"w-full max-w-5xl bg-gray-800 shadow-md rounded-lg overflow-hidden\">\n                    <div className=\"overflow-x-auto\">\n                        <table className=\"w-full text-sm text-gray-300\">\n                            <thead className=\"bg-blue-600 text-white uppercase text-xs\">\n                                <tr>\n                                    <th className=\"px-4 py-2\">Order ID</th>\n                                    <th className=\"px-4 py-2\">Security ID</th>\n                                    <th className=\"px-4 py-2\">Type</th>\n                                    <th className=\"px-4 py-2\">Quantity</th>\n                                    <th className=\"px-4 py-2\">Entry Price</th>\n                                    <th className=\"px-4 py-2\">Latest Price</th>\n                                    <th className=\"px-4 py-2\">PnL</th>\n                                    <th className=\"px-4 py-2\">PnL %</th>\n                                    <th className=\"px-4 py-2\">Profit/Loss</th>\n                                </tr>\n                            </thead>\n                            <tbody className=\"divide-y divide-gray-700\">\n                                {pnlData.length === 0 ? (\n                                    <tr>\n                                        <td colSpan=\"9\" className=\"p-4 text-center text-gray-500\">\n                                            No orders available.\n                                        </td>\n                                    </tr>\n                                ) : (\n                                    pnlData.map((order) => {\n                                        const currentPrice = livePrices[order.security_id] ?? order.price;\n                                        const pnl = ((currentPrice - order.price) * order.quantity).toFixed(2);\n                                        const pnlPercentage = (((currentPrice - order.price) / order.price) * 100).toFixed(2);\n                                        const profitLoss = pnl >= 0 ? \"Profit\" : \"Loss\";\n                                        return (\n                                            <tr key={order.order_id} className=\"hover:bg-gray-700\">\n                                                <td className=\"px-4 py-2\">{order.order_id ?? \"N/A\"}</td>\n                                                <td className=\"px-4 py-2\">{order.security_id ?? \"N/A\"}</td>\n                                                <td className=\"px-4 py-2\">{order.transaction_type ?? \"N/A\"}</td>\n                                                <td className=\"px-4 py-2\">{order.quantity ?? \"N/A\"}</td>\n                                                <td className=\"px-4 py-2\">{order.price ?? \"N/A\"}</td>\n                                                <td className=\"px-4 py-2 text-yellow-400 font-semibold\">{currentPrice}</td>\n                                                <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnl}</td>\n                                                <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{pnlPercentage}%</td>\n                                                <td className={`px-4 py-2 ${pnl >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{profitLoss}</td>\n                                            </tr>\n                                        );\n                                    })\n                                )}\n                            </tbody>\n                            <tfoot className=\"bg-gray-700 text-white font-bold\">\n                                <tr>\n                                    <td colSpan=\"6\" className=\"px-6 py-2 text-left\">Total:</td>\n                                    <td className={`px-4 py-2 ${totalPnL >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnL}</td>\n                                    <td className={`px-4 py-2 ${totalPnLPercentage >= 0 ? \"text-green-500\" : \"text-red-500\"}`}>{totalPnLPercentage}%</td>\n                                    <td className=\"px-4 py-2\">â€”</td>\n                                </tr>\n                            </tfoot>\n                        </table>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default PnlReport;\n"],"mappings":";;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAGA;;AAKA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAIA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAUA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAYA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;A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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}